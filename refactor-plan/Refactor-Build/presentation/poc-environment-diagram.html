<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OneStream POC Environment Architecture</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f8f9fa;
        }
        
        .diagram-container {
            background-color: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .diagram-title {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #0078d4;
        }
        
        svg {
            width: 100%;
            height: auto;
            border: 1px solid #e9ecef;
            border-radius: 4px;
        }
        
        .legend {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #0078d4;
        }
        
        .legend h3 {
            margin-top: 0;
            color: #0078d4;
        }
        
        .legend-item {
            display: inline-block;
            margin: 5px 15px 5px 0;
            font-size: 0.9rem;
        }
        
        .color-box {
            display: inline-block;
            width: 15px;
            height: 15px;
            margin-right: 5px;
            vertical-align: middle;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="diagram-container">
        <div class="diagram-title">Diagram 1: OneStream POC Environment Architecture</div>
        
        <svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
            <!-- Background -->
            <rect width="1200" height="800" fill="#f8f9fa" stroke="none"/>
            
            <!-- Azure Subscription Container -->
            <rect x="50" y="50" width="1100" height="700" fill="none" stroke="#0078d4" stroke-width="3" stroke-dasharray="10,5" rx="10"/>
            <text x="600" y="35" text-anchor="middle" font-size="18" font-weight="bold" fill="#0078d4">Azure Subscription: onestream-poc</text>
            
            <!-- Shared Resource Group -->
            <rect x="80" y="80" width="300" height="200" fill="#f8f9fa" stroke="#6c757d" stroke-width="2" rx="5"/>
            <text x="230" y="100" text-anchor="middle" font-size="14" font-weight="bold" fill="#6c757d">Shared Resource Group</text>
            <text x="230" y="115" text-anchor="middle" font-size="12" fill="#6c757d">onestream-poc-shared-rg</text>
            
            <!-- Key Vaults in Shared RG -->
            <rect x="100" y="130" width="120" height="60" fill="#ffc107" stroke="#f57c00" stroke-width="2" rx="5"/>
            <text x="160" y="150" text-anchor="middle" font-size="10" font-weight="bold">Key Vault</text>
            <text x="160" y="162" text-anchor="middle" font-size="9">cosign-kv</text>
            <text x="160" y="174" text-anchor="middle" font-size="9">Signing Keys</text>
            
            <rect x="240" y="130" width="120" height="60" fill="#ffc107" stroke="#f57c00" stroke-width="2" rx="5"/>
            <text x="300" y="150" text-anchor="middle" font-size="10" font-weight="bold">Key Vault</text>
            <text x="300" y="162" text-anchor="middle" font-size="9">secrets-kv</text>
            <text x="300" y="174" text-anchor="middle" font-size="9">App Secrets</text>
            
            <!-- Virtual Network -->
            <rect x="100" y="210" width="260" height="50" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
            <text x="230" y="232" text-anchor="middle" font-size="12" font-weight="bold">Virtual Network: onestream-poc-vnet</text>
            <text x="230" y="246" text-anchor="middle" font-size="10">10.100.0.0/16</text>
            
            <!-- Development Environment -->
            <rect x="420" y="80" width="300" height="300" fill="#e8f5e8" stroke="#4caf50" stroke-width="2" rx="5"/>
            <text x="570" y="100" text-anchor="middle" font-size="14" font-weight="bold" fill="#2e7d32">Development Environment</text>
            <text x="570" y="115" text-anchor="middle" font-size="12" fill="#2e7d32">onestream-poc-dev-rg</text>
            
            <!-- Dev ACR -->
            <rect x="440" y="130" width="120" height="70" fill="#4caf50" stroke="#2e7d32" stroke-width="2" rx="5"/>
            <text x="500" y="150" text-anchor="middle" font-size="10" font-weight="bold">Container Registry</text>
            <text x="500" y="162" text-anchor="middle" font-size="9">onestreampocdex</text>
            <text x="500" y="174" text-anchor="middle" font-size="9">Premium Tier</text>
            <text x="500" y="186" text-anchor="middle" font-size="9">30-day retention</text>
            
            <!-- Dev AKS -->
            <rect x="580" y="130" width="120" height="70" fill="#4caf50" stroke="#2e7d32" stroke-width="2" rx="5"/>
            <text x="640" y="150" text-anchor="middle" font-size="10" font-weight="bold">AKS Cluster</text>
            <text x="640" y="162" text-anchor="middle" font-size="9">onestream-poc-dev-aks</text>
            <text x="640" y="174" text-anchor="middle" font-size="9">2 nodes</text>
            <text x="640" y="186" text-anchor="middle" font-size="9">Standard_D2s_v3</text>
            
            <!-- Dev Service Principal -->
            <rect x="440" y="220" width="260" height="40" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1" rx="3"/>
            <text x="570" y="237" text-anchor="middle" font-size="10" font-weight="bold">sp-onestream-poc-dev-pipeline</text>
            <text x="570" y="250" text-anchor="middle" font-size="9">AcrPush + AKS Deploy + Key Vault Access</text>
            
            <!-- Dev Subnet -->
            <rect x="440" y="280" width="260" height="30" fill="#f1f8e9" stroke="#689f38" stroke-width="1" rx="3"/>
            <text x="570" y="297" text-anchor="middle" font-size="10">Subnet: 10.100.1.0/24 (AKS Nodes)</text>
            
            <!-- Staging Environment -->
            <rect x="750" y="80" width="300" height="300" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
            <text x="900" y="100" text-anchor="middle" font-size="14" font-weight="bold" fill="#e65100">Staging Environment</text>
            <text x="900" y="115" text-anchor="middle" font-size="12" fill="#e65100">onestream-poc-staging-rg</text>
            
            <!-- Staging ACR -->
            <rect x="770" y="130" width="120" height="70" fill="#ff9800" stroke="#e65100" stroke-width="2" rx="5"/>
            <text x="830" y="150" text-anchor="middle" font-size="10" font-weight="bold">Container Registry</text>
            <text x="830" y="162" text-anchor="middle" font-size="9">onestreampocstaging</text>
            <text x="830" y="174" text-anchor="middle" font-size="9">Premium Tier</text>
            <text x="830" y="186" text-anchor="middle" font-size="9">90-day retention</text>
            
            <!-- Staging AKS -->
            <rect x="910" y="130" width="120" height="70" fill="#ff9800" stroke="#e65100" stroke-width="2" rx="5"/>
            <text x="970" y="150" text-anchor="middle" font-size="10" font-weight="bold">AKS Cluster</text>
            <text x="970" y="162" text-anchor="middle" font-size="9">onestream-poc-staging-aks</text>
            <text x="970" y="174" text-anchor="middle" font-size="9">2 nodes</text>
            <text x="970" y="186" text-anchor="middle" font-size="9">Standard_D2s_v3</text>
            
            <!-- Staging Service Principal -->
            <rect x="770" y="220" width="260" height="40" fill="#ffe0b2" stroke="#e65100" stroke-width="1" rx="3"/>
            <text x="900" y="237" text-anchor="middle" font-size="10" font-weight="bold">sp-onestream-poc-staging-pipeline</text>
            <text x="900" y="250" text-anchor="middle" font-size="9">AcrPull + AKS Deploy (Read-only)</text>
            
            <!-- Staging Subnet -->
            <rect x="770" y="280" width="260" height="30" fill="#fff8e1" stroke="#ffa000" stroke-width="1" rx="3"/>
            <text x="900" y="297" text-anchor="middle" font-size="10">Subnet: 10.100.2.0/24 (AKS Nodes)</text>
            
            <!-- Azure DevOps Section -->
            <rect x="80" y="400" width="300" height="200" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="5"/>
            <text x="230" y="420" text-anchor="middle" font-size="14" font-weight="bold" fill="#1976d2">Azure DevOps</text>
            <text x="230" y="435" text-anchor="middle" font-size="12" fill="#1976d2">OneStream-Pipeline-POC</text>
            
            <!-- Pipelines -->
            <rect x="100" y="450" width="260" height="30" fill="#2196f3" stroke="#1976d2" stroke-width="1" rx="3"/>
            <text x="230" y="467" text-anchor="middle" font-size="10" fill="white" font-weight="bold">iam-poc-build-pipeline</text>
            
            <rect x="100" y="490" width="260" height="30" fill="#2196f3" stroke="#1976d2" stroke-width="1" rx="3"/>
            <text x="230" y="507" text-anchor="middle" font-size="10" fill="white" font-weight="bold">iam-poc-promotion-pipeline</text>
            
            <rect x="100" y="530" width="260" height="30" fill="#2196f3" stroke="#1976d2" stroke-width="1" rx="3"/>
            <text x="230" y="547" text-anchor="middle" font-size="10" fill="white" font-weight="bold">iam-poc-deploy-pipeline</text>
            
            <!-- Promotion Engine -->
            <rect x="420" y="400" width="300" height="150" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
            <text x="570" y="420" text-anchor="middle" font-size="14" font-weight="bold" fill="#7b1fa2">Promotion Engine</text>
            
            <rect x="440" y="440" width="260" height="40" fill="#9c27b0" stroke="#7b1fa2" stroke-width="1" rx="3"/>
            <text x="570" y="457" text-anchor="middle" font-size="10" fill="white" font-weight="bold">sp-onestream-poc-promotion-engine</text>
            <text x="570" y="470" text-anchor="middle" font-size="9" fill="white">Cross-ACR Import + Signature Verification</text>
            
            <rect x="440" y="490" width="260" height="40" fill="#e1bee7" stroke="#7b1fa2" stroke-width="1" rx="3"/>
            <text x="570" y="507" text-anchor="middle" font-size="10" font-weight="bold">Immutable Digest Management</text>
            <text x="570" y="520" text-anchor="middle" font-size="9">sha256:abc123... references</text>
            
            <!-- Network Isolation -->
            <rect x="750" y="400" width="300" height="150" fill="#ffebee" stroke="#f44336" stroke-width="2" rx="5"/>
            <text x="900" y="420" text-anchor="middle" font-size="14" font-weight="bold" fill="#c62828">Network Isolation</text>
            
            <rect x="770" y="440" width="260" height="25" fill="#ffcdd2" stroke="#c62828" stroke-width="1" rx="3"/>
            <text x="900" y="455" text-anchor="middle" font-size="9">üö´ No production network access</text>
            
            <rect x="770" y="470" width="260" height="25" fill="#ffcdd2" stroke="#c62828" stroke-width="1" rx="3"/>
            <text x="900" y="485" text-anchor="middle" font-size="9">üîí Isolated DNS and service discovery</text>
            
            <rect x="770" y="500" width="260" height="25" fill="#ffcdd2" stroke="#c62828" stroke-width="1" rx="3"/>
            <text x="900" y="515" text-anchor="middle" font-size="9">üõ°Ô∏è Separate monitoring and logging</text>
            
            <!-- Connection Arrows -->
            <!-- Dev Pipeline to Dev ACR -->
            <line x1="500" y1="260" x2="500" y2="200" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
            
            <!-- Dev Pipeline to Dev AKS -->
            <line x1="640" y1="260" x2="640" y2="200" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowhead-green)"/>
            
            <!-- Promotion Engine to both ACRs -->
            <line x1="500" y1="440" x2="500" y2="200" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-purple)"/>
            <line x1="640" y1="440" x2="830" y2="200" stroke="#9c27b0" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-purple)"/>
            
            <!-- Staging Pipeline to Staging ACR -->
            <line x1="830" y1="260" x2="830" y2="200" stroke="#ff9800" stroke-width="2" marker-end="url(#arrowhead-orange)"/>
            
            <!-- Staging Pipeline to Staging AKS -->
            <line x1="970" y1="260" x2="970" y2="200" stroke="#ff9800" stroke-width="2" marker-end="url(#arrowhead-orange)"/>
            
            <!-- Azure DevOps to Service Principals -->
            <line x1="380" y1="500" x2="440" y2="240" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
            <line x1="380" y1="520" x2="770" y2="240" stroke="#2196f3" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
            
            <!-- Key Vault Access -->
            <line x1="160" y1="190" x2="500" y2="220" stroke="#ffc107" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrowhead-yellow)"/>
            <line x1="300" y1="190" x2="570" y2="440" stroke="#ffc107" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrowhead-yellow)"/>
            
            <!-- Arrow markers -->
            <defs>
                <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#4caf50"/>
                </marker>
                <marker id="arrowhead-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#ff9800"/>
                </marker>
                <marker id="arrowhead-purple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#9c27b0"/>
                </marker>
                <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#2196f3"/>
                </marker>
                <marker id="arrowhead-yellow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#ffc107"/>
                </marker>
            </defs>
            
            <!-- Legend Labels -->
            <text x="80" y="650" font-size="12" font-weight="bold" fill="#333">Security Boundaries:</text>
            <text x="80" y="670" font-size="10" fill="#666">üîµ Development (Green) | üü† Staging (Orange) | üü£ Cross-Environment (Purple)</text>
            <text x="80" y="690" font-size="10" fill="#666">üîí Least Privilege Access | üö´ Network Isolation | üõ°Ô∏è Zero Production Impact</text>
            
            <!-- Resource Counts -->
            <rect x="80" y="720" width="200" height="50" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1" rx="3"/>
            <text x="180" y="735" text-anchor="middle" font-size="10" font-weight="bold">Resource Summary</text>
            <text x="90" y="750" font-size="9">‚Ä¢ 3 Service Principals</text>
            <text x="90" y="762" font-size="9">‚Ä¢ 2 ACR Instances</text>
            
            <rect x="300" y="720" width="200" height="50" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1" rx="3"/>
            <text x="400" y="735" text-anchor="middle" font-size="10" font-weight="bold">Cost Estimate</text>
            <text x="310" y="750" font-size="9">‚Ä¢ ~$500/month POC cost</text>
            <text x="310" y="762" font-size="9">‚Ä¢ 3-month evaluation period</text>
        </svg>
        
        <div class="legend">
            <h3>Component Legend</h3>
            <div class="legend-item">
                <span class="color-box" style="background-color: #e8f5e8; border-color: #4caf50;"></span>
                Development Environment
            </div>
            <div class="legend-item">
                <span class="color-box" style="background-color: #fff3e0; border-color: #ff9800;"></span>
                Staging Environment
            </div>
            <div class="legend-item">
                <span class="color-box" style="background-color: #f3e5f5; border-color: #9c27b0;"></span>
                Promotion Engine
            </div>
            <div class="legend-item">
                <span class="color-box" style="background-color: #e3f2fd; border-color: #2196f3;"></span>
                Azure DevOps
            </div>
            <div class="legend-item">
                <span class="color-box" style="background-color: #f8f9fa; border-color: #6c757d;"></span>
                Shared Services
            </div>
            <div class="legend-item">
                <span class="color-box" style="background-color: #ffebee; border-color: #f44336;"></span>
                Security Controls
            </div>
        </div>
    </div>
</body>
</html>