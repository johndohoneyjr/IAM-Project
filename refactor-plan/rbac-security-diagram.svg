<?xml version="1.0" encoding="UTF-8"?>
<svg width="1600" height="1400" viewBox="0 0 1600 1400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Gradients -->
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#0078d4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#106ebe;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="entraGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f3e5f5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8e24aa;stop-opacity:0.8" />
    </linearGradient>
    
    <linearGradient id="devSecGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4caf50;stop-opacity:0.8" />
    </linearGradient>
    
    <linearGradient id="testSecGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f57c00;stop-opacity:0.8" />
    </linearGradient>
    
    <linearGradient id="prodSecGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fce4ec;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e91e63;stop-opacity:0.8" />
    </linearGradient>
    
    <linearGradient id="rbacGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e1f5fe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0277bd;stop-opacity:0.8" />
    </linearGradient>
    
    <!-- Drop shadow filter -->
    <filter id="dropshadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="3" flood-color="#00000040"/>
    </filter>
    
    <!-- Arrow markers -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
    
    <marker id="arrowheadSecurity" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#d32f2f" />
    </marker>
    
    <marker id="arrowheadAccess" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8e24aa" />
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1600" height="1400" fill="#fafafa"/>
  
  <!-- Header -->
  <rect x="0" y="0" width="1600" height="80" fill="url(#headerGradient)" filter="url(#dropshadow)"/>
  <text x="800" y="35" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="24" font-weight="bold" fill="white">
    OneStream RBAC Security Architecture &amp; Least Privilege Model
  </text>
  <text x="800" y="60" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" fill="#e6f3ff">
    Azure Entra ID Role-Based Access Control for DevOps Pipeline Security
  </text>
  
  <!-- Azure Entra ID Central Authority -->
  <rect x="50" y="100" width="300" height="900" rx="10" ry="10" 
        fill="url(#entraGradient)" stroke="#8e24aa" stroke-width="2" filter="url(#dropshadow)"/>
  <text x="200" y="130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="18" font-weight="bold" fill="#4a148c">
    Azure Entra ID
  </text>
  <text x="200" y="150" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" fill="#333">
    Identity &amp; Access Management
  </text>
  
  <!-- Service Principals -->
  <rect x="70" y="170" width="260" height="180" rx="6" ry="6" 
        fill="white" stroke="#7b1fa2" stroke-width="1.5"/>
  <text x="200" y="190" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#4a148c">
    Service Principals
  </text>
  <text x="200" y="210" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    Automated Authentication Identities
  </text>
  
  <!-- Dev Pipeline SP -->
  <rect x="80" y="220" width="240" height="35" rx="4" ry="4" 
        fill="#e8f5e8" stroke="#4caf50" stroke-width="1"/>
  <text x="200" y="235" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    sp-onestream-poc-dev-pipeline
  </text>
  <text x="200" y="248" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="8" fill="#333">
    Build, Test, Deploy to Dev Environment
  </text>
  
  <!-- Staging Pipeline SP -->
  <rect x="80" y="260" width="240" height="35" rx="4" ry="4" 
        fill="#fff3e0" stroke="#f57c00" stroke-width="1"/>
  <text x="200" y="275" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#ef6c00">
    sp-onestream-poc-staging-pipeline
  </text>
  <text x="200" y="288" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="8" fill="#333">
    Deploy to Staging Environment (Read-Only)
  </text>
  
  <!-- Production Pipeline SP -->
  <rect x="80" y="300" width="240" height="35" rx="4" ry="4" 
        fill="#fce4ec" stroke="#e91e63" stroke-width="1"/>
  <text x="200" y="315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#ad1457">
    sp-onestream-poc-prod-pipeline
  </text>
  <text x="200" y="328" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="8" fill="#333">
    Deploy to Production (Manual Approval)
  </text>
  
  <!-- Azure Built-in Roles -->
  <rect x="70" y="370" width="260" height="200" rx="6" ry="6" 
        fill="white" stroke="#7b1fa2" stroke-width="1.5"/>
  <text x="200" y="390" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#4a148c">
    Azure Built-in RBAC Roles
  </text>
  <text x="200" y="410" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    Least Privilege Role Assignments
  </text>
  
  <!-- Role boxes -->
  <rect x="80" y="420" width="240" height="25" rx="3" ry="3" 
        fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
  <text x="200" y="435" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" font-weight="bold" fill="#0d47a1">
    AcrPush - Build and push container images
  </text>
  
  <rect x="80" y="450" width="240" height="25" rx="3" ry="3" 
        fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
  <text x="200" y="465" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" font-weight="bold" fill="#0d47a1">
    AcrPull - Pull container images for deployment
  </text>
  
  <rect x="80" y="480" width="240" height="25" rx="3" ry="3" 
        fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
  <text x="200" y="495" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" font-weight="bold" fill="#0d47a1">
    AcrImportImage - Direct ACR-to-ACR promotion
  </text>
  
  <rect x="80" y="510" width="240" height="25" rx="3" ry="3" 
        fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
  <text x="200" y="525" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" font-weight="bold" fill="#0d47a1">
    Azure Kubernetes Service Cluster User
  </text>
  
  <rect x="80" y="540" width="240" height="25" rx="3" ry="3" 
        fill="#e3f2fd" stroke="#1976d2" stroke-width="1"/>
  <text x="200" y="555" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" font-weight="bold" fill="#0d47a1">
    Key Vault Crypto User (HSM Operations)
  </text>
  
  <!-- Conditional Access Policies -->
  <rect x="70" y="590" width="260" height="140" rx="6" ry="6" 
        fill="white" stroke="#7b1fa2" stroke-width="1.5"/>
  <text x="200" y="610" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#4a148c">
    Conditional Access Policies
  </text>
  <text x="200" y="630" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ IP allowlisting for pipeline agents
  </text>
  <text x="200" y="645" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Device compliance requirements
  </text>
  <text x="200" y="660" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Multi-factor authentication
  </text>
  <text x="200" y="675" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Risk-based authentication
  </text>
  <text x="200" y="690" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Session timeout controls
  </text>
  <text x="200" y="705" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Application access restrictions
  </text>
  <text x="200" y="720" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Continuous access evaluation
  </text>
  
  <!-- Privileged Identity Management -->
  <rect x="70" y="750" width="260" height="120" rx="6" ry="6" 
        fill="white" stroke="#7b1fa2" stroke-width="1.5"/>
  <text x="200" y="770" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#4a148c">
    Privileged Identity Management
  </text>
  <text x="200" y="790" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Just-in-time access activation
  </text>
  <text x="200" y="805" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Time-bound role assignments
  </text>
  <text x="200" y="820" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Approval workflows for elevation
  </text>
  <text x="200" y="835" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Access reviews and recertification
  </text>
  <text x="200" y="850" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Audit trail for privileged operations
  </text>
  
  <!-- Audit and Monitoring -->
  <rect x="70" y="890" width="260" height="100" rx="6" ry="6" 
        fill="white" stroke="#7b1fa2" stroke-width="1.5"/>
  <text x="200" y="910" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#4a148c">
    Identity Security Monitoring
  </text>
  <text x="200" y="930" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Sign-in risk detection
  </text>
  <text x="200" y="945" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Unusual access pattern alerts
  </text>
  <text x="200" y="960" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Service principal activity tracking
  </text>
  <text x="200" y="975" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Access review compliance reports
  </text>
  
  <!-- Development Environment Security -->
  <rect x="400" y="100" width="350" height="380" rx="10" ry="10" 
        fill="url(#devSecGradient)" stroke="#4caf50" stroke-width="2" filter="url(#dropshadow)"/>
  <text x="575" y="130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="18" font-weight="bold" fill="#1b5e20">
    Development Environment Security
  </text>
  <text x="575" y="150" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" fill="#333">
    onestream-poc-dev-rg Resource Group
  </text>
  
  <!-- Dev SP Permissions -->
  <rect x="420" y="170" width="310" height="120" rx="6" ry="6" 
        fill="white" stroke="#388e3c" stroke-width="1.5"/>
  <text x="575" y="190" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#2e7d32">
    sp-onestream-poc-dev-pipeline Permissions
  </text>
  <text x="575" y="210" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì AcrPush on onestreamdev.azurecr.io
  </text>
  <text x="575" y="225" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì AcrPull on onestreamdev.azurecr.io
  </text>
  <text x="575" y="240" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì Azure Kubernetes Service Cluster User
  </text>
  <text x="575" y="255" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì Key Vault Crypto User (signing keys only)
  </text>
  <text x="575" y="270" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úó NO access to staging or production resources
  </text>
  
  <!-- Dev Security Boundaries -->
  <rect x="420" y="310" width="310" height="80" rx="6" ry="6" 
        fill="white" stroke="#388e3c" stroke-width="1.5"/>
  <text x="575" y="330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#2e7d32">
    Network Security Boundaries
  </text>
  <text x="575" y="350" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Virtual network isolation (10.100.0.0/16)
  </text>
  <text x="575" y="365" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Network security groups with deny-by-default
  </text>
  <text x="575" y="380" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Private endpoints for ACR and Key Vault
  </text>
  
  <!-- Dev Cosign Operations -->
  <rect x="420" y="410" width="310" height="60" rx="6" ry="6" 
        fill="white" stroke="#388e3c" stroke-width="1.5"/>
  <text x="575" y="430" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#2e7d32">
    Cryptographic Signing Operations
  </text>
  <text x="575" y="450" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Cosign signing with Azure Key Vault HSM
  </text>
  <text x="575" y="465" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ FIPS 140-2 Level 3 compliance for signing keys
  </text>
  
  <!-- Test/Staging Environment Security -->
  <rect x="800" y="100" width="350" height="380" rx="10" ry="10" 
        fill="url(#testSecGradient)" stroke="#f57c00" stroke-width="2" filter="url(#dropshadow)"/>
  <text x="975" y="130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="18" font-weight="bold" fill="#e65100">
    Test/Staging Environment Security
  </text>
  <text x="975" y="150" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" fill="#333">
    onestream-poc-staging-rg Resource Group
  </text>
  
  <!-- Staging SP Permissions -->
  <rect x="820" y="170" width="310" height="120" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="975" y="190" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#ef6c00">
    sp-onestream-poc-staging-pipeline Permissions
  </text>
  <text x="975" y="210" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì AcrPull on onestreamstaging.azurecr.io (READ-ONLY)
  </text>
  <text x="975" y="225" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì Azure Kubernetes Service Cluster User
  </text>
  <text x="975" y="240" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì Key Vault Crypto User (verification only)
  </text>
  <text x="975" y="255" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úó NO push/build permissions
  </text>
  <text x="975" y="270" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úó NO access to dev or production resources
  </text>
  
  <!-- Promotion Engine -->
  <rect x="820" y="310" width="310" height="80" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="975" y="330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#ef6c00">
    sp-onestream-poc-promotion-engine
  </text>
  <text x="975" y="350" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ AcrPull from dev registry
  </text>
  <text x="975" y="365" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ AcrImportImage to staging registry
  </text>
  <text x="975" y="380" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Signature verification before import
  </text>
  
  <!-- Staging Approval Gates -->
  <rect x="820" y="410" width="310" height="60" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="975" y="430" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#ef6c00">
    Manual Approval Gates
  </text>
  <text x="975" y="450" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Security team approval for staging deployment
  </text>
  <text x="975" y="465" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Automated vulnerability scan pass required
  </text>
  
  <!-- Production Environment Security -->
  <rect x="1200" y="100" width="350" height="380" rx="10" ry="10" 
        fill="url(#prodSecGradient)" stroke="#e91e63" stroke-width="2" filter="url(#dropshadow)"/>
  <text x="1375" y="130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="18" font-weight="bold" fill="#ad1457">
    Production Environment Security
  </text>
  <text x="1375" y="150" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" fill="#333">
    onestream-poc-prod-rg Resource Group
  </text>
  
  <!-- Production SP Permissions -->
  <rect x="1220" y="170" width="310" height="140" rx="6" ry="6" 
        fill="white" stroke="#c2185b" stroke-width="1.5"/>
  <text x="1375" y="190" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#ad1457">
    sp-onestream-poc-prod-pipeline Permissions
  </text>
  <text x="1375" y="210" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì AcrPull on onestreamprod.azurecr.io (READ-ONLY)
  </text>
  <text x="1375" y="225" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì Azure Kubernetes Service Cluster User
  </text>
  <text x="1375" y="240" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úì Key Vault Crypto User (verification only)
  </text>
  <text x="1375" y="255" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úó STRICT READ-ONLY access pattern
  </text>
  <text x="1375" y="270" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úó NO build or modification permissions
  </text>
  <text x="1375" y="285" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úó NO access to dev or staging environments
  </text>
  <text x="1375" y="300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚úó Break-glass emergency access only
  </text>
  
  <!-- Production Approval Gates -->
  <rect x="1220" y="330" width="310" height="100" rx="6" ry="6" 
        fill="white" stroke="#c2185b" stroke-width="1.5"/>
  <text x="1375" y="350" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="14" font-weight="bold" fill="#ad1457">
    Production Approval Gates
  </text>
  <text x="1375" y="370" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Change advisory board approval required
  </text>
  <text x="1375" y="385" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Security scan &amp; compliance validation
  </text>
  <text x="1375" y="400" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Business owner sign-off
  </text>
  <text x="1375" y="415" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" fill="#333">
    ‚Ä¢ Two-person integrity control
  </text>
  
  <!-- Production Security Controls -->
  <rect x="1220" y="450" width="310" height="30" rx="6" ry="6" 
        fill="white" stroke="#c2185b" stroke-width="1.5"/>
  <text x="1375" y="468" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="#ad1457">
    üõ°Ô∏è Enhanced Security Controls: FIPS, Immutable Policy, Zero Trust
  </text>
  
  <!-- Cross-Environment Security Framework -->
  <rect x="400" y="520" width="750" height="320" rx="10" ry="10" 
        fill="url(#rbacGradient)" stroke="#0277bd" stroke-width="2" filter="url(#dropshadow)"/>
  <text x="775" y="550" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="18" font-weight="bold" fill="#01579b">
    Cross-Environment Security Framework
  </text>
  <text x="775" y="570" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" fill="#333">
    Zero Trust Architecture &amp; Defense in Depth
  </text>
  
  <!-- Security principle boxes -->
  <rect x="430" y="590" width="200" height="110" rx="6" ry="6" 
        fill="white" stroke="#0277bd" stroke-width="1.5"/>
  <text x="530" y="610" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="#01579b">
    Least Privilege Principle
  </text>
  <text x="530" y="630" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Minimum required permissions only
  </text>
  <text x="530" y="645" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Environment-specific boundaries
  </text>
  <text x="530" y="660" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ No cross-environment access
  </text>
  <text x="530" y="675" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Regular access reviews
  </text>
  <text x="530" y="690" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Automated deprovisioning
  </text>
  
  <rect x="650" y="590" width="200" height="110" rx="6" ry="6" 
        fill="white" stroke="#0277bd" stroke-width="1.5"/>
  <text x="750" y="610" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="#01579b">
    Zero Trust Network
  </text>
  <text x="750" y="630" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Never trust, always verify
  </text>
  <text x="750" y="645" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Micro-segmentation
  </text>
  <text x="750" y="660" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ End-to-end encryption
  </text>
  <text x="750" y="675" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Continuous verification
  </text>
  <text x="750" y="690" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Device compliance
  </text>
  
  <rect x="870" y="590" width="200" height="110" rx="6" ry="6" 
        fill="white" stroke="#0277bd" stroke-width="1.5"/>
  <text x="970" y="610" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="#01579b">
    Defense in Depth
  </text>
  <text x="970" y="630" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Multiple security layers
  </text>
  <text x="970" y="645" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Network security groups
  </text>
  <text x="970" y="660" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Application-level security
  </text>
  <text x="970" y="675" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Data encryption at rest/transit
  </text>
  <text x="970" y="690" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Runtime protection
  </text>
  
  <!-- Compliance row -->
  <rect x="430" y="720" width="200" height="100" rx="6" ry="6" 
        fill="white" stroke="#0277bd" stroke-width="1.5"/>
  <text x="530" y="740" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="#01579b">
    Compliance Framework
  </text>
  <text x="530" y="760" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ SOC 2 Type II controls
  </text>
  <text x="530" y="775" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ NIST Cybersecurity Framework
  </text>
  <text x="530" y="790" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ GDPR data protection
  </text>
  <text x="530" y="805" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Industry best practices
  </text>
  
  <rect x="650" y="720" width="200" height="100" rx="6" ry="6" 
        fill="white" stroke="#0277bd" stroke-width="1.5"/>
  <text x="750" y="740" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="#01579b">
    Audit &amp; Monitoring
  </text>
  <text x="750" y="760" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Real-time security monitoring
  </text>
  <text x="750" y="775" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Automated threat detection
  </text>
  <text x="750" y="790" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Complete audit trails
  </text>
  <text x="750" y="805" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Forensic capabilities
  </text>
  
  <rect x="870" y="720" width="200" height="100" rx="6" ry="6" 
        fill="white" stroke="#0277bd" stroke-width="1.5"/>
  <text x="970" y="740" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="12" font-weight="bold" fill="#01579b">
    Incident Response
  </text>
  <text x="970" y="760" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Automated incident detection
  </text>
  <text x="970" y="775" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Rapid containment procedures
  </text>
  <text x="970" y="790" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Recovery &amp; business continuity
  </text>
  <text x="970" y="805" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚Ä¢ Lessons learned integration
  </text>
  
  <!-- Security Flow Arrows -->
  <!-- Entra ID to Dev -->
  <path d="M 350,280 L 390,280" stroke="#8e24aa" stroke-width="3" marker-end="url(#arrowheadAccess)"/>
  <text x="370" y="270" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#8e24aa" font-weight="bold">
    Identity
  </text>
  
  <!-- Entra ID to Staging -->
  <path d="M 350,310 L 780,310 L 780,280 L 790,280" stroke="#8e24aa" stroke-width="3" marker-end="url(#arrowheadAccess)"/>
  <text x="570" y="300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#8e24aa" font-weight="bold">
    Read-Only Access
  </text>
  
  <!-- Entra ID to Production -->
  <path d="M 350,340 L 1180,340 L 1180,280 L 1190,280" stroke="#8e24aa" stroke-width="3" marker-end="url(#arrowheadAccess)"/>
  <text x="770" y="330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#8e24aa" font-weight="bold">
    Restricted Production Access
  </text>
  
  <!-- Security Validation Indicators -->
  <rect x="50" y="1040" width="1500" height="160" rx="10" ry="10" 
        fill="#fff3e0" stroke="#f57c00" stroke-width="2" filter="url(#dropshadow)"/>
  <text x="800" y="1070" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="18" font-weight="bold" fill="#e65100">
    Security Validation &amp; Compliance Checkpoints
  </text>
  
  <!-- Validation checkpoints -->
  <rect x="100" y="1090" width="220" height="90" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="210" y="1110" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#e65100">
    Identity Security Validation
  </text>
  <text x="210" y="1130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Service principal least privilege
  </text>
  <text x="210" y="1145" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Conditional access compliance
  </text>
  <text x="210" y="1160" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Multi-factor authentication
  </text>
  <text x="210" y="1175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Regular access reviews
  </text>
  
  <rect x="340" y="1090" width="220" height="90" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="450" y="1110" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#e65100">
    Network Security Validation
  </text>
  <text x="450" y="1130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Virtual network isolation
  </text>
  <text x="450" y="1145" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Private endpoint connectivity
  </text>
  <text x="450" y="1160" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì NSG deny-by-default rules
  </text>
  <text x="450" y="1175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Zero trust architecture
  </text>
  
  <rect x="580" y="1090" width="220" height="90" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="690" y="1110" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#e65100">
    Cryptographic Validation
  </text>
  <text x="690" y="1130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì HSM-backed signing keys
  </text>
  <text x="690" y="1145" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì FIPS 140-2 Level 3 compliance
  </text>
  <text x="690" y="1160" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Cosign signature verification
  </text>
  <text x="690" y="1175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Supply chain attestation
  </text>
  
  <rect x="820" y="1090" width="220" height="90" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="930" y="1110" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#e65100">
    Deployment Security Validation
  </text>
  <text x="930" y="1130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Immutable container images
  </text>
  <text x="930" y="1145" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Vulnerability scan passes
  </text>
  <text x="930" y="1160" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Policy compliance checks
  </text>
  <text x="930" y="1175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Runtime security monitoring
  </text>
  
  <rect x="1060" y="1090" width="220" height="90" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="1170" y="1110" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#e65100">
    Audit &amp; Compliance Validation
  </text>
  <text x="1170" y="1130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Complete audit logging
  </text>
  <text x="1170" y="1145" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì SOC 2 control validation
  </text>
  <text x="1170" y="1160" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Change tracking &amp; approval
  </text>
  <text x="1170" y="1175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Incident response procedures
  </text>
  
  <rect x="1300" y="1090" width="220" height="90" rx="6" ry="6" 
        fill="white" stroke="#f57c00" stroke-width="1.5"/>
  <text x="1410" y="1110" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="11" font-weight="bold" fill="#e65100">
    Governance Validation
  </text>
  <text x="1410" y="1130" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Change advisory board review
  </text>
  <text x="1410" y="1145" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Risk assessment &amp; mitigation
  </text>
  <text x="1410" y="1160" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Business impact analysis
  </text>
  <text x="1410" y="1175" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    ‚úì Stakeholder approval gates
  </text>
  
  <!-- Key Security Metrics -->
  <rect x="50" y="1230" width="1500" height="120" rx="10" ry="10" 
        fill="#e8f5e8" stroke="#4caf50" stroke-width="2" filter="url(#dropshadow)"/>
  <text x="800" y="1260" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="18" font-weight="bold" fill="#1b5e20">
    Security Metrics &amp; Key Performance Indicators
  </text>
  
  <!-- Security KPIs -->
  <rect x="100" y="1280" width="180" height="60" rx="6" ry="6" 
        fill="white" stroke="#4caf50" stroke-width="1.5"/>
  <text x="190" y="1300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    Zero Security Incidents
  </text>
  <text x="190" y="1315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Target: No security breaches
  </text>
  <text x="190" y="1330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Continuous monitoring &amp; response
  </text>
  
  <rect x="300" y="1280" width="180" height="60" rx="6" ry="6" 
        fill="white" stroke="#4caf50" stroke-width="1.5"/>
  <text x="390" y="1300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    100% Signature Verification
  </text>
  <text x="390" y="1315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    All deployments cryptographically signed
  </text>
  <text x="390" y="1330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Supply chain integrity guaranteed
  </text>
  
  <rect x="500" y="1280" width="180" height="60" rx="6" ry="6" 
        fill="white" stroke="#4caf50" stroke-width="1.5"/>
  <text x="590" y="1300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    &lt;5 min Response Time
  </text>
  <text x="590" y="1315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Automated incident detection
  </text>
  <text x="590" y="1330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Rapid containment procedures
  </text>
  
  <rect x="700" y="1280" width="180" height="60" rx="6" ry="6" 
        fill="white" stroke="#4caf50" stroke-width="1.5"/>
  <text x="790" y="1300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    100% Compliance Score
  </text>
  <text x="790" y="1315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    SOC 2 &amp; NIST framework alignment
  </text>
  <text x="790" y="1330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Continuous compliance monitoring
  </text>
  
  <rect x="900" y="1280" width="180" height="60" rx="6" ry="6" 
        fill="white" stroke="#4caf50" stroke-width="1.5"/>
  <text x="990" y="1300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    Quarterly Access Reviews
  </text>
  <text x="990" y="1315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Regular permission audits
  </text>
  <text x="990" y="1330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Automated deprovisioning
  </text>
  
  <rect x="1100" y="1280" width="180" height="60" rx="6" ry="6" 
        fill="white" stroke="#4caf50" stroke-width="1.5"/>
  <text x="1190" y="1300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    Zero Privilege Escalation
  </text>
  <text x="1190" y="1315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Strict least privilege enforcement
  </text>
  <text x="1190" y="1330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Environment isolation maintained
  </text>
  
  <rect x="1300" y="1280" width="180" height="60" rx="6" ry="6" 
        fill="white" stroke="#4caf50" stroke-width="1.5"/>
  <text x="1390" y="1300" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="10" font-weight="bold" fill="#2e7d32">
    99.9% Availability SLA
  </text>
  <text x="1390" y="1315" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    High availability with security
  </text>
  <text x="1390" y="1330" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="9" fill="#333">
    Zero-downtime deployments
  </text>
  
  <!-- Footer -->
  <text x="800" y="1380" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" 
        font-size="11" fill="#666">
    OneStream Security Architecture | Executive Governance Review | Azure Entra ID RBAC &amp; Least Privilege Model
  </text>
</svg>